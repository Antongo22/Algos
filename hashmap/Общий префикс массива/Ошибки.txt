Было тяжеловато, ну и немного тупил. Вроде как сделал.